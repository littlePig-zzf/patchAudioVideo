# 随机音视频拼接工具 - 使用说明

## 📦 打包完成

✅ 可执行文件已生成在 `dist/` 目录中:
- **macOS 应用**: `dist/随机音视频拼接工具.app` (双击即可运行)
- **可执行文件**: `dist/随机音视频拼接工具` (终端运行)

应用大小: 约 11MB (轻量级打包,不含 Whisper)

---

## 🚀 快速开始

### 1. 安装必需依赖

```bash
# macOS 用户
brew install ffmpeg

# 检查安装是否成功
ffmpeg -version
```

### 2. 运行应用

**方式一: 双击运行 (推荐)**
```
直接双击 dist/随机音视频拼接工具.app
```

**方式二: 终端运行**
```bash
./dist/随机音视频拼接工具
```

### 3. 界面说明

应用启动后会显示一个图形界面,包含以下设置:

#### 基本设置
- **目标时长**: 设置视频的目标时长(分钟),按名称拼接音乐时可留空
- **生成视频数量**: 一次生成多少个视频
- **视频速度倍数**: 视频播放速度(1.0 = 正常速度)
- **音频速度倍数**: 音频播放速度(1.0 = 正常速度)

#### 选项
- **保留原声**: 保留视频原声并混合背景音乐
- **按名称拼接音乐**: 按文件名顺序拼接音乐
- **启用字幕**: 为视频添加字幕

#### 字幕设置
- **字幕文件夹**: 存放 SRT/ASS 字幕文件的文件夹
- **字幕字体**: 默认使用 "ZY Oliver" 字体
- **字幕字号**: 字体大小(像素)
- **字幕识别语言**: Whisper 自动识别时的语言(留空自动检测)

#### 视频设置
- **指定第一个视频**: 可选,指定作为开头的视频文件
- **主体视频文件夹**: 包含视频素材的文件夹
- **开头素材文件夹**: 可选,专门用于开头的视频素材
- **从开头素材拼接数量**: 从开头素材中选择几个片段

#### 音频设置
- **音乐文件夹**: 包含背景音乐的文件夹
- **指定第一首音乐**: 可选,指定作为开头的音乐
- **输出文件夹**: 生成的视频保存位置

---

## 💡 使用技巧

### 技巧 1: 按名称拼接全部音乐

适合制作完整音乐专辑视频:

1. ✅ 勾选"按名称拼接音乐"
2. ✅ 留空"目标时长"
3. 🎵 音乐会按文件名顺序拼接,每首只用一次
4. 📹 视频时长 = 所有音乐的总时长

### 技巧 2: 使用字幕

**方式一: 提供 SRT/ASS 文件 (推荐)**
1. 为每个音频文件准备同名的字幕文件
   - 例如: `音乐1.mp3` → `音乐1.ass`
2. 将字幕文件放在"字幕文件夹"中
3. 勾选"启用字幕"
4. 系统会自动拼接字幕

**方式二: Whisper 自动识别**
1. 安装 Whisper: `pip install openai-whisper`
2. 勾选"启用字幕",不提供字幕文件夹
3. 系统会自动识别音频内容生成字幕

**字幕优先级**: ASS → SRT → Whisper 自动识别

### 技巧 3: 保留视频原声

勾选"保留原声"可以:
- 保留视频的原始音频
- 混合背景音乐(背景音乐音量 1.5x)
- 适合制作 vlog 风格视频

### 技巧 4: 控制视频和音频速度

- **加快节奏**: 视频速度 1.5x,音频速度 1.2x
- **慢动作**: 视频速度 0.5x,音频速度 1.0x
- **快速预览**: 视频速度 2.0x,音频速度 2.0x

---

## 📁 文件结构示例

```
项目文件夹/
├── videos/              # 视频素材文件夹
│   ├── video1.mp4
│   ├── video2.mp4
│   └── video3.mp4
│
├── opening/             # 开头素材文件夹
│   ├── intro1.mp4
│   └── intro2.mp4
│
├── music/               # 音乐文件夹
│   ├── song1.mp3
│   ├── song2.mp3
│   └── song3.mp3
│
├── subtitles/           # 字幕文件夹
│   ├── song1.ass
│   ├── song2.ass
│   └── song3.ass
│
└── output/              # 输出文件夹
    └── final_video_08m30s.mp4
```

---

## ⚠️ 常见问题

### Q1: 提示"未找到 ffmpeg"
**A**: 安装 FFmpeg:
```bash
brew install ffmpeg
```

### Q2: 字幕自动识别失败
**A**: 确保安装了 Whisper:
```bash
pip install openai-whisper
```

### Q3: 应用无法打开 (macOS)
**A**: macOS 安全限制,运行:
```bash
xattr -cr "dist/随机音视频拼接工具.app"
```

### Q4: 生成的视频没有声音
**A**: 检查:
- 音乐文件夹是否包含音频文件
- 音频文件格式是否支持 (.mp3, .wav, .flac)

### Q5: 视频和音频不同步
**A**:
- 避免同时调整视频和音频速度
- 或确保速度倍数相同

### Q6: 打包后体积太大
**A**: 当前打包方案已经很轻量(11MB),如需更小:
- 不打包,直接运行 Python 脚本
- 参考 `README_打包说明.md`

---

## 🔧 高级功能

### 批量生成多个视频

设置"生成视频数量"为 N,会生成 N 个不同的视频:
- 每个视频使用不同的随机素材组合
- 文件名自动编号: `final_video_08m30s_01.mp4`, `final_video_08m30s_02.mp4`

### 自定义字幕样式

编辑 ASS 字幕文件可以:
- 修改字体、颜色、大小
- 添加特效和动画
- 精确控制时间轴

### 混合多种素材

可以:
- 主体素材 + 开头素材混合使用
- 前 N 个片段使用开头素材
- 之后使用主体素材循环

---

## 📊 性能参考

**测试配置**: MacBook Pro M1, 16GB RAM

| 任务 | 时长 | 耗时 |
|------|------|------|
| 8分钟视频 (无字幕) | 8min | ~2-3min |
| 8分钟视频 (SRT字幕) | 8min | ~3-4min |
| 8分钟视频 (Whisper字幕) | 8min | ~10-15min |
| 批量生成 5 个视频 | 40min | ~15-20min |

*Whisper 首次使用会下载模型(约 140MB)*

---

## 🆘 获取帮助

如遇问题:
1. 查看"运行日志"窗口的错误信息
2. 检查 FFmpeg 是否正确安装
3. 确认文件路径和格式正确
4. 查看本说明文档的常见问题

---

## 📝 更新日志

### v1.0.0 (2025-11-11)
- ✅ 支持随机音视频拼接
- ✅ 支持 SRT/ASS 字幕拼接
- ✅ 支持 Whisper 自动字幕识别
- ✅ 支持按名称拼接全部音乐
- ✅ 支持保留原声混音
- ✅ 优先匹配 ASS 字幕
- ✅ 优化 UI 界面和交互

---

**祝使用愉快! 🎉**
